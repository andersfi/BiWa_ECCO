-- SELECT column_name
-- FROM information_schema.columns
-- WHERE table_schema = 'public'
--   AND table_name   = 'ecco_biwa_lake_catchments';

-- Codes to CORINE landcover http://sia.eionet.europa.eu/CLC2000/classes


create view view_output_north_euro_lake_surv_with_catchmentdata as 
select ST_Area(a.geom) as catchment_area_m, 
       a.ebint,
a.corine_2000_continuous_urban_fabric_area_km2 as corine2000_111, 
       a.corine_2000_discontinuous_urban_fabric_area_km2 as corine2000_112,
       a.corine_2000_industrial_or_commercial_units_area_km2 as corine2000_121,
       a.corine_2000_road_and_rail_networks_and_associated_land_area_km2 as corine2000_122,
       a.corine_2000_port_areas_area_km2 as corine2000_123,
       a.corine_2000_airports_area_km2 as corine2000_124,
       a.corine_2000_mineral_extraction_sites_area_km2 as corine2000_131,
       a.corine_2000_dump_sites_area_km2 as corine2000_132,
       a.corine_2000_construction_sites_area_km2 as corine2000_133,
       a.corine_2000_green_urban_areas_area_km2 as corine2000_141,
       a.corine_2000_sport_and_leisure_facilities_area_km2 as corine2000_142,
       a.corine_2000_non_irrigated_arable_land_area_km2 as corine2000_211,
       a.corine_2000_permanently_irrigated_land_area_km2 as corine2000_212,
       a.corine_2000_rice_fields_area_km2 as corine2000_213,
       a.corine_2000_vineyards_area_km2 as corine2000_221,
       a.corine_2000_fruit_trees_and_berry_plantations_area_km2 as corine2000_222,
       a.corine_2000_olive_groves_area_km2 as corine2000_223,
       a.corine_2000_pastures_area_km2 as corine2000_231,
       a.corine_2000_annual_crops_associated_with_permanent_crops_area_k as corine2000_241,
       a.corine_2000_complex_cultivation_patterns_area_km2 as corine2000_242,
       a.corine_2000_land_principally_occupied_by_agriculture_with_signi as corine2000_243,
       a.corine_2000_agro_forestry_areas_area_km2 as corine2000_244,
       a.corine_2000_broad_leaved_forest_area_km2 as corine2000_311,
       a.corine_2000_coniferous_forest_area_km2 as corine2000_312,
       a.corine_2000_mixed_forest_area_km2 as corine2000_313,
       a.corine_2000_natural_grasslands_area_km2 as corine2000_321,
       a.corine_2000_moors_and_heathland_area_km2 as corine2000_322,
       a.corine_2000_sclerophyllous_vegetation_area_km2 as corine2000_323,
       a.corine_2000_transitional_woodland_shrub_area_km2 as corine2000_324,
       a.corine_2000_beaches_dunes_sands_area_km2 as corine2000_331,
       a.corine_2000_bare_rocks_area_km2 as corine2000_332,
       a.corine_2000_sparsely_vegetated_areas_area_km2 as corine2000_333,
       a.corine_2000_burnt_areas_area_km2 as corine2000_334,
       a.corine_2000_glaciers_and_perpetual_snow_area_km2 as corine2000_335,
       a.corine_2000_inland_marshes_area_km2 as corine2000_411,
       a.corine_2000_peat_bogs_area_km2 as corine2000_412,
       a.corine_2000_salt_marshes_area_km2 as corine2000_421,
       a.corine_2000_salines_area_km2 as corine2000_422,
       a.corine_2000_intertidal_flats_area_km2 as corine2000_423, 
       a.corine_2000_water_courses_area_km2 as corine2000_511,
       a.corine_2000_water_bodies_area_km2 as corine2000_512,
       a.corine_2000_coastal_lagoons_area_km2 as corine2000_521,
       a.corine_2000_estuaries_area_km2 as corine2000_522,
       a.corine_2000_sea_and_ocean_area_km2 as corine2000_523,
       a.corine_2006_continuous_urban_fabric_area_km2 as corine2006_111, 
       a.corine_2006_discontinuous_urban_fabric_area_km2 as corine2006_112,
       a.corine_2006_industrial_or_commercial_units_area_km2 as corine2006_121,
       a.corine_2006_road_and_rail_networks_and_associated_land_area_km2 as corine2006_122,
       a.corine_2006_port_areas_area_km2 as corine2006_123,
       a.corine_2006_airports_area_km2 as corine2006_124,
       a.corine_2006_mineral_extraction_sites_area_km2 as corine2006_131,
       a.corine_2006_dump_sites_area_km2 as corine2006_132,
       a.corine_2006_construction_sites_area_km2 as corine2006_133,
       a.corine_2006_green_urban_areas_area_km2 as corine2006_141,
       a.corine_2006_sport_and_leisure_facilities_area_km2 as corine2006_142,
       a.corine_2006_non_irrigated_arable_land_area_km2 as corine2006_211,
       a.corine_2006_permanently_irrigated_land_area_km2 as corine2006_212,
       a.corine_2006_rice_fields_area_km2 as corine2006_213,
       a.corine_2006_vineyards_area_km2 as corine2006_221,
       a.corine_2006_fruit_trees_and_berry_plantations_area_km2 as corine2006_222,
       a.corine_2006_olive_groves_area_km2 as corine2006_223,
       a.corine_2006_pastures_area_km2 as corine2006_231,
       a.corine_2006_annual_crops_associated_with_permanent_crops_area_k as corine2006_241,
       a.corine_2006_complex_cultivation_patterns_area_km2 as corine2006_242,
       a.corine_2006_land_principally_occupied_by_agriculture_with_signi as corine2006_243,
       a.corine_2006_agro_forestry_areas_area_km2 as corine2006_244,
       a.corine_2006_broad_leaved_forest_area_km2 as corine2006_311,
       a.corine_2006_coniferous_forest_area_km2 as corine2006_312,
       a.corine_2006_mixed_forest_area_km2 as corine2006_313,
       a.corine_2006_natural_grasslands_area_km2 as corine2006_321,
       a.corine_2006_moors_and_heathland_area_km2 as corine2006_322,
       a.corine_2006_sclerophyllous_vegetation_area_km2 as corine2006_323,
       a.corine_2006_transitional_woodland_shrub_area_km2 as corine2006_324,
       a.corine_2006_beaches_dunes_sands_area_km2 as corine2006_331,
       a.corine_2006_bare_rocks_area_km2 as corine2006_332,
       a.corine_2006_sparsely_vegetated_areas_area_km2 as corine2006_333,
       a.corine_2006_burnt_areas_area_km2 as corine2006_334,
       a.corine_2006_glaciers_and_perpetual_snow_area_km2 as corine2006_335,
       a.corine_2006_inland_marshes_area_km2 as corine2006_411,
       a.corine_2006_peat_bogs_area_km2 as corine2006_412,
       a.corine_2006_salt_marshes_area_km2 as corine2006_421,
       a.corine_2006_salines_area_km2 as corine2006_422,
       a.corine_2006_intertidal_flats_area_km2 as corine2006_423,
       a.corine_2006_water_courses_area_km2 as corine2006_511,
       a.corine_2006_water_bodies_area_km2 as corine2006_512,
       a.corine_2006_coastal_lagoons_area_km2 as corine2006_521,
       a.corine_2006_estuaries_area_km2 as corine2006_522,
       a.corine_2006_sea_and_ocean_area_km2 as corine2006_523,
       a.ndvi_gimms_4km_1993_01_median as ndvi_1993_01,
       a.ndvi_gimms_4km_1993_02_median as ndvi_1993_02,
        a.ndvi_gimms_4km_1993_03_median as ndvi_1993_03,
       a.ndvi_gimms_4km_1993_04_median as ndvi_1993_04,
       a.ndvi_gimms_4km_1993_05_median as ndvi_1993_05,
       a.ndvi_gimms_4km_1993_06_median as ndvi_1993_06,
       a.ndvi_gimms_4km_1993_07_median as ndvi_1993_07,
       a.ndvi_gimms_4km_1993_08_median as ndvi_1993_08,
       a.ndvi_gimms_4km_1993_09_median as ndvi_1993_09,
       a.ndvi_gimms_4km_1993_10_median as ndvi_1993_10,
       a.ndvi_gimms_4km_1993_11_median as ndvi_1993_11,
       a.ndvi_gimms_4km_1993_12_median as ndvi_1993_12,
       a.ndvi_gimms_4km_1994_01_median as ndvi_1994_01,
       a.ndvi_gimms_4km_1994_02_median as ndvi_1994_02,
       a.ndvi_gimms_4km_1994_03_median as ndvi_1994_03,
       a.ndvi_gimms_4km_1994_04_median as ndvi_1994_04,
       a.ndvi_gimms_4km_1994_05_median as ndvi_1994_05,
       a.ndvi_gimms_4km_1994_06_median as ndvi_1994_06,
       a.ndvi_gimms_4km_1994_07_median as ndvi_1994_07,
       a.ndvi_gimms_4km_1994_08_median as ndvi_1994_08,
       a.ndvi_gimms_4km_1994_09_median as ndvi_1994_09,
       a.ndvi_gimms_4km_1994_10_median as ndvi_1994_10,
       a.ndvi_gimms_4km_1994_11_median as ndvi_1994_11,
       a.ndvi_gimms_4km_1994_12_median as ndvi_1994_12,
       a.ndvi_gimms_4km_1995_01_median as ndvi_1995_01,
       a.ndvi_gimms_4km_1995_02_median as ndvi_1995_02,
       a.ndvi_gimms_4km_1995_03_median as ndvi_1995_03,
       a.ndvi_gimms_4km_1995_04_median as ndvi_1995_04,
       a.ndvi_gimms_4km_1995_05_median as ndvi_1995_05,
       a.ndvi_gimms_4km_1995_06_median as ndvi_1995_06,
       a.ndvi_gimms_4km_1995_07_median as ndvi_1995_07,
       a.ndvi_gimms_4km_1995_08_median as ndvi_1995_08,
       a.ndvi_gimms_4km_1995_09_median as ndvi_1995_09,
       a.ndvi_gimms_4km_1995_10_median as ndvi_1995_10,
       a.ndvi_gimms_4km_1995_11_median as ndvi_1995_11,
       a.altitude_sum,
       a.altitude_minimum,
       a.altitude_first_quartile,
       a.altitude_median,
       a.altitude_average,
       a.altitude_third_quartile,
       a.altitude_maximum,
       a.altitude_stddev,
       a.altitude_var,
       a.slope_sum,
       a.slope_minimum,
       a.slope_first_quartile,
       a.slope_median,
       a.slope_average,
       a.slope_third_quartile,
       a.slope_maximum,
       a.slope_stddev,
       a.slope_var,
       a.flow_accum_sum,
       a.flow_accum_minimum,
       a.flow_accum_first_quartile,
       a.flow_accum_median,
       a.flow_accum_average,
       a.flow_accum_third_quartile,
       a.flow_accum_maximum,
       a.flow_accum_stddev,
       a.flow_accum_var,
       b.nation, 
 	 b.lake_name,  
      b.date, 
	b.latitude, 
	b.longitude, b.ph, b.k25_ms_m, b.alk_e_ueq_l, 
      b.so4_ueq_l, b.no3_ueq_l, b.f_ueq_l, b.tot_p_ug_l, b.tot_n_ug_l, 
      b.toc_mg_l, b.non_marine_so4, b.ca_mg_na_k__ueq_l, 
      b.s_dep_g_s_m2_a, b.no3_dep_g_n_m2_a, b.nh4_dep_g_n_m2_a, 
      b.no3_ug_l, b.dist_closest_ebint, b.no_lakes_in_250m, 
      b.no_lakes_in_100m, b.no_lakes_in_10m, b.dist_2nd_closest_ebint, 
      c.runoff_dmi_2001_2010_jj, 
      c.runoff_dmi_2001_2010_mjja, 
      c.airtemp_dmi_2001_2010_jj, 
      c.airtemp_dmi_2001_2010_mjja
from ecco_biwa_lake_catchments as a,
    north_euro_lake_surv_1995 as b, 
    catchment_cordex_sept2015 as c
where a.ebint = b.ebint and b.ebint = c.ebint;



--- Needs to remove some of the unrealistic runoff values from the model (ditch the lakes). 
--- select runoff_dmi_2001_2010_jj from view_north_euro_lake_surv_with_catchmentdata_oct2015 limit 30;
